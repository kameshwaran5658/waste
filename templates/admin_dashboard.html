<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin Dashboard | Smart Food Waste Management</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Animate.css -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
:root {
  /* Color System */
  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --primary-light: #818cf8;
  --secondary: #a855f7;
  --accent: #ec4899;
  --success: #10b981;
  --info: #3b82f6;
  --warning: #f59e0b;
  --danger: #ef4444;
  --light: #f9fafb;
  --dark: #1f2937;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;
  
  /* Shadows */
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
  
  /* Spacing */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-2xl: 3rem;
  
  /* Border Radius */
  --radius-sm: 0.25rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.5rem;
  --radius-full: 9999px;
}

/* Reset & Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  background-color: var(--gray-100);
  color: var(--gray-800);
  line-height: 1.6;
  overflow-x: hidden;
  position: relative;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(circle at 10% 20%, rgba(99, 102, 241, 0.03) 0%, rgba(168, 85, 247, 0.03) 90%);
  z-index: -1;
  pointer-events: none;
}

body::after {
  content: '';
  position: fixed;
  top: 0;
  right: 0;
  width: 400px;
  height: 400px;
  background: radial-gradient(circle, rgba(236, 72, 153, 0.1) 0%, rgba(99, 102, 241, 0.05) 70%);
  z-index: -1;
  pointer-events: none;
  border-radius: 50%;
  transform: translate(30%, -30%);
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: var(--gray-200);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--primary-light), var(--primary));
  border-radius: var(--radius-full);
  border: 2px solid var(--gray-200);
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, var(--primary), var(--secondary));
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 1rem;
  color: var(--gray-900);
}

p {
  margin-bottom: 1rem;
}

a {
  color: var(--primary);
  text-decoration: none;
  transition: all 0.3s ease;
}

a:hover {
  color: var(--primary-dark);
}

/* Layout Components */
.sidebar {
  height: 100vh;
  width: 280px;
  position: fixed;
  top: 0;
  left: 0;
  background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary) 100%);
  padding: 1.5rem;
  overflow-y: auto;
  box-shadow: var(--shadow-lg);
  z-index: 100;
  transition: all 0.3s ease;
}

.sidebar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  opacity: 0.1;
  z-index: -1;
}

.sidebar-brand {
  display: flex;
  align-items: center;
  padding-bottom: 1.5rem;
  margin-bottom: 1.5rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.sidebar-brand h4 {
  color: white;
  margin-bottom: 0;
  font-weight: 600;
  font-size: 1.25rem;
}

.sidebar a {
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  display: flex;
  align-items: center;
  padding: 0.75rem 1rem;
  margin-bottom: 0.5rem;
  border-radius: var(--radius-lg);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.sidebar a::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 100%;
  background: rgba(255, 255, 255, 0.1);
  transition: width 0.3s ease;
  z-index: -1;
}

.sidebar a:hover {
  color: white;
  transform: translateX(5px);
}

.sidebar a:hover::before {
  width: 100%;
}

.sidebar a i {
  margin-right: 0.75rem;
  font-size: 1.1rem;
  transition: transform 0.3s ease;
}

.sidebar a:hover i {
  transform: rotate(5deg);
}

.sidebar a.active {
  background: rgba(255, 255, 255, 0.2);
  color: white;
  font-weight: 600;
  box-shadow: var(--shadow);
}

.main {
  margin-left: 280px;
  padding: 2rem;
  transition: all 0.3s ease;
}

.navbar {
  margin-left: 280px;
  padding: 1rem 2rem;
  background: white;
  box-shadow: var(--shadow);
  transition: all 0.3s ease;
  position: sticky;
  top: 0;
  z-index: 99;
}

.navbar-brand {
  font-weight: 700;
  background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
}

/* Cards & Containers */
.card {
  background: white;
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow);
  transition: all 0.3s ease;
  border: none;
  overflow: hidden;
  height: 100%;
}

.card:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-3px);
}

.card-header {
  background: white;
  border-bottom: 1px solid var(--gray-200);
  padding: 1.25rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.card-header.gradient {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  border-bottom: none;
}

.card-header h5 {
  margin-bottom: 0;
  font-weight: 600;
}

.card-body {
  padding: 1.5rem;
}

.gradient-card {
  position: relative;
  padding-top: 4px;
  background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
}

.gradient-card-inner {
  background: white;
  border-radius: var(--radius-lg);
  padding: 1.5rem;
  height: 100%;
}

/* Meal Cards */
.meal-card {
  position: relative;
  height: 100%;
  transition: all 0.3s ease;
}

.meal-card-header {
  padding: 1rem;
  border-radius: var(--radius-lg) var(--radius-lg) 0 0;
  color: white;
  font-weight: 600;
  display: flex;
  align-items: center;
}

.meal-card-header i {
  margin-right: 0.75rem;
  font-size: 1.1rem;
}

.meal-card-body {
  padding: 1.25rem;
}

.meal-item {
  padding: 0.75rem;
  border-radius: var(--radius-md);
  background: var(--gray-100);
  margin-bottom: 0.75rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.3s ease;
  cursor: pointer;
}

.meal-item:hover {
  background: var(--gray-200);
  transform: translateX(5px);
}

.meal-item:last-child {
  margin-bottom: 0;
}

.meal-item-name {
  display: flex;
  align-items: center;
}

.meal-item-name i {
  margin-right: 0.75rem;
  color: var(--gray-500);
}

.meal-item-quantity {
  padding: 0.25rem 0.75rem;
  border-radius: var(--radius-full);
  font-size: 0.85rem;
  font-weight: 600;
  background: linear-gradient(135deg, var(--primary-light) 0%, var(--secondary) 100%);
  color: white;
}

/* Dashboard Widgets */
.welcome-card {
  background: white;
  border-radius: var(--radius-xl);
  padding: 2rem;
  margin-bottom: 2rem;
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow);
}

.welcome-card::before {
  content: '';
  position: absolute;
  top: -100px;
  right: -100px;
  width: 300px;
  height: 300px;
  background: linear-gradient(135deg, var(--primary-light) 0%, var(--secondary) 100%);
  border-radius: 50%;
  opacity: 0.07;
  z-index: 0;
}

.welcome-content {
  position: relative;
  z-index: 1;
}

.welcome-content h3 {
  font-weight: 700;
  font-size: 1.75rem;
  margin-bottom: 0.5rem;
  background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-fill-color: transparent;
}

.welcome-content p {
  color: var(--gray-600);
  margin-bottom: 0;
}

/* Ingredients Section */
.ingredients-card {
  background: white;
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow);
}

.ingredients-header {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  padding: 1.25rem 1.5rem;
  color: white;
}

.ingredients-header h5 {
  margin-bottom: 0;
  font-weight: 600;
  color: white;
  display: flex;
  align-items: center;
}

.ingredients-header h5 i {
  margin-right: 0.75rem;
}

.ingredients-table {
  width: 100%;
}

.ingredients-table th {
  padding: 1rem;
  font-weight: 600;
  color: var(--gray-700);
  border-bottom: 2px solid var(--gray-200);
}

.ingredients-table td {
  padding: 1rem;
  vertical-align: middle;
  border-bottom: 1px solid var(--gray-200);
}

.ingredients-table tr:last-child td {
  border-bottom: none;
}

.ingredients-table tr:hover {
  background-color: var(--gray-100);
}

.ingredient-badge {
  padding: 0.25rem 0.75rem;
  border-radius: var(--radius-full);
  font-size: 0.85rem;
  font-weight: 600;
  background: var(--success);
  color: white;
}

/* Buttons & Controls */
.btn {
  font-weight: 500;
  padding: 0.625rem 1.25rem;
  border-radius: var(--radius-md);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: none;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 100%;
  background-color: rgba(255, 255, 255, 0.2);
  transition: width 0.3s ease;
  z-index: 0;
}

.btn:hover::before {
  width: 100%;
}

.btn i {
  margin-right: 0.5rem;
}

.btn-primary {
  background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
}

.btn-primary:hover {
  background: linear-gradient(90deg, var(--primary-dark) 0%, var(--primary) 100%);
}

.btn-success {
  background: linear-gradient(90deg, var(--success) 0%, #059669 100%);
  color: white;
}

.btn-danger {
  background: linear-gradient(90deg, var(--danger) 0%, #b91c1c 100%);
  color: white;
}

.btn-warning {
  background: linear-gradient(90deg, var(--warning) 0%, #d97706 100%);
  color: white;
}

.btn-info {
  background: linear-gradient(90deg, var(--info) 0%, #2563eb 100%);
  color: white;
}

.btn-lg {
  padding: 0.75rem 1.5rem;
  font-size: 1.1rem;
}

.btn-sm {
  padding: 0.375rem 0.75rem;
  font-size: 0.875rem;
}

/* Form Controls */
.form-control, .form-select {
  padding: 0.75rem 1rem;
  border-radius: var(--radius-md);
  border: 1px solid var(--gray-300);
  transition: all 0.3s ease;
  color: var(--gray-700);
  background-color: white;
}

.form-control:focus, .form-select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.form-label {
  font-weight: 500;
  color: var(--gray-700);
  margin-bottom: 0.5rem;
}

/* Badges */
.badge {
  padding: 0.35em 0.65em;
  font-size: 0.75em;
  font-weight: 600;
  border-radius: var(--radius-full);
}

.badge-gradient {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
}

/* Modal */
.modal-content {
  border: none;
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-lg);
}

.modal-header {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  border-bottom: none;
  padding: 1.25rem 1.5rem;
}

.modal-title {
  font-weight: 600;
  color: white;
}

.modal-body {
  padding: 1.5rem;
}

.modal-footer {
  border-top: 1px solid var(--gray-200);
  padding: 1.25rem 1.5rem;
}

/* Table */
.table {
  width: 100%;
  margin-bottom: 1rem;
  color: var(--gray-800);
  vertical-align: middle;
  border-color: var(--gray-200);
}

.table thead th {
  font-weight: 600;
  background-color: var(--gray-100);
  color: var(--gray-700);
  border-bottom: 2px solid var(--gray-200);
  padding: 0.75rem 1rem;
}

.table tbody td {
  padding: 1rem;
  border-bottom: 1px solid var(--gray-200);
}

.table-hover tbody tr:hover {
  background-color: rgba(99, 102, 241, 0.05);
}

/* Utilities */
.hidden {
  display: none !important;
}

.animate__animated {
  animation-duration: 0.5s;
}

.animate__fadeIn {
  animation-name: fadeIn;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Responsive Design */
@media (max-width: 1200px) {
  .sidebar {
    width: 240px;
  }
  .main, .navbar {
    margin-left: 240px;
  }
}

@media (max-width: 992px) {
  .sidebar {
    width: 80px;
    padding: 1rem 0.5rem;
  }
  .sidebar-brand h4, .sidebar a span {
    display: none;
  }
  .sidebar a {
    justify-content: center;
    padding: 0.75rem;
  }
  .sidebar a i {
    margin-right: 0;
    font-size: 1.25rem;
  }
  .main, .navbar {
    margin-left: 80px;
  }
}

@media (max-width: 768px) {
  .sidebar {
    width: 100%;
    height: auto;
    position: relative;
    padding: 1rem;
  }
  .sidebar-brand h4, .sidebar a span {
    display: block;
  }
  .sidebar a {
    justify-content: flex-start;
    padding: 0.75rem 1rem;
  }
  .sidebar a i {
    margin-right: 0.75rem;
  }
  .main, .navbar {
    margin-left: 0;
  }
  .navbar {
    position: relative;
  }
}

/* Additional Effects */
.floating {
  animation: float 5s ease-in-out infinite;
}

@keyframes float {
  0% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-15px);
  }
  100% {
    transform: translateY(0px);
  }
}

.rotating {
  animation: rotate 10s linear infinite;
}

@keyframes rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* Custom Toggle Switch */
.toggle-switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--gray-300);
  transition: .4s;
  border-radius: 34px;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .toggle-slider {
  background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
}

input:focus + .toggle-slider {
  box-shadow: 0 0 1px var(--primary);
}

input:checked + .toggle-slider:before {
  transform: translateX(26px);
}

/* Pulse Animation */
.pulse {
  animation: pulse-animation 2s infinite;
}

@keyframes pulse-animation {
  0% {
    box-shadow: 0 0 0 0px rgba(99, 102, 241, 0.2);
  }
  100% {
    box-shadow: 0 0 0 20px rgba(99, 102, 241, 0);
  }
}

/* Attendance Cards */
.attendance-card {
  transition: all 0.3s ease;
}

.attendance-card:hover {
  transform: translateY(-5px);
}

.attendance-date {
  font-weight: 700;
  font-size: 1.1rem;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.attendance-count {
  color: var(--gray-600);
}

/* Menu Section */
.menu-item {
  display: flex;
  align-items: center;
  padding: 0.5rem 0;
}

.menu-item:before {
  content: 'üçΩÔ∏è';
  margin-right: 0.75rem;
}

/* Ingredients Modal */
.ingredient-list {
  list-style: none;
  padding: 0;
}

.ingredient-list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background-color: var(--gray-100);
  margin-bottom: 0.5rem;
  border-radius: var(--radius-md);
  transition: all 0.3s ease;
}

.ingredient-list-item:hover {
  background-color: var(--gray-200);
}

.ingredient-list-item:last-child {
  margin-bottom: 0;
}

/* Stats Cards */
.stat-card {
  background: white;
  border-radius: var(--radius-lg);
  padding: 1.5rem;
  position: relative;
  overflow: hidden;
  height: 100%;
  box-shadow: var(--shadow);
  transition: all 0.3s ease;
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-md);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 5px;
  height: 100%;
  background: linear-gradient(to bottom, var(--primary), var(--secondary));
}

.stat-icon {
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
  color: white;
  border-radius: 12px;
  font-size: 1.5rem;
  margin-bottom: 1rem;
}

.stat-value {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.25rem;
  color: var(--gray-900);
}

.stat-label {
  color: var(--gray-600);
  font-size: 0.9rem;
}

/* Activity Timeline */
.timeline {
  position: relative;
  padding-left: 2rem;
}

.timeline::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 2px;
  background: linear-gradient(to bottom, var(--primary), var(--secondary));
}

.timeline-item {
  position: relative;
  padding-bottom: 1.5rem;
}

.timeline-item:last-child {
  padding-bottom: 0;
}

.timeline-dot {
  position: absolute;
  left: -2.5rem;
  width: 1rem;
  height: 1rem;
  border-radius: 50%;
  background: var(--primary);
  border: 2px solid white;
  box-shadow: var(--shadow-sm);
}

.timeline-content {
  background: white;
  border-radius: var(--radius-md);
  padding: 1rem;
  box-shadow: var(--shadow-sm);
}

.timeline-date {
  color: var(--gray-500);
  font-size: 0.85rem;
}

.timeline-title {
  font-weight: 600;
  margin: 0.5rem 0;
}

/* User Profile */
.user-profile {
  display: flex;
  align-items: center;
}

.user-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  margin-right: 0.75rem;
}

.user-name {
  font-weight: 600;
  color: var(--gray-800);
}

  </style>
</head>

<body>

<!-- Sidebar -->
<div class="sidebar animate__animated animate__fadeInLeft">
  <h4 class="text-white mb-4">Admin Panel</h4>
  <a onclick="showSection('dashboard')"><i class="bi bi-speedometer2 me-2"></i> Dashboard</a>
  <a onclick="showSection('attendance')"><i class="bi bi-people-fill me-2"></i> Attendance</a>
  <a onclick="showSection('menus')"><i class="bi bi-journal-text me-2"></i> Menus</a>
  <a onclick="showSection('settings')"><i class="bi bi-gear-fill me-2"></i> Settings</a>
  <a href="{{ url_for('admin_logout') }}"><i class="bi bi-box-arrow-right me-2"></i> Logout</a>
</div>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm px-4">
  <div class="container-fluid">
    <h5 class="navbar-brand fw-bold mb-0">Smart Food Waste Management</h5>
    <div class="d-flex align-items-center">
      <i class="bi bi-person-circle fs-4 me-2"></i>
      <span class="fw-semibold">{{ admin.full_name }}</span>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="main">
  <div class="container-fluid">
<!-- Main Dashboard Section -->
<!-- Full Premium Powerful Dashboard -->
<div id="dashboard" class="animate__animated animate__fadeIn" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height:100vh; padding: 30px;">

  <!-- Welcome Card -->
  <div class="card mb-5 p-4 shadow rounded-4 border-0 bg-white">
    <div class="d-flex align-items-center">
      <i class="fas fa-tachometer-alt fa-3x text-primary me-4"></i>
      <div>
        <h3 class="fw-bold mb-1">Welcome, {{ admin.full_name }}!</h3>
        <p class="text-muted mb-0">Manage food waste smartly with real-time predictions.</p>
      </div>
    </div>
  </div>

  <!-- Today's Meal Suggestions -->
  <h4 class="fw-bold mb-4 text-dark"><i class="fas fa-utensils me-2"></i>Today's Meal Predictions</h4>
  <div class="row g-4">
    {% set meal_colors = {'Breakfast':'#FF9F43', 'Lunch':'#4B7BEC', 'Snacks':'#32D74B', 'Dinner':'#FC5C65'} %}
    {% set meal_icons = {'Breakfast':'fas fa-mug-hot', 'Lunch':'fas fa-hamburger', 'Snacks':'fas fa-cookie-bite', 'Dinner':'fas fa-pizza-slice'} %}
    {% set meals = ['Breakfast', 'Lunch', 'Snacks', 'Dinner'] %}

    {% for meal in meals %}
    <div class="col-md-6">
      <div class="card border-0 shadow rounded-4 animate__animated animate__fadeInUp" style="background: rgba(255, 255, 255, 0.85);">
        <div class="card-header d-flex align-items-center rounded-top-4" style="background-color: {{ meal_colors[meal] }};">
          <i class="{{ meal_icons[meal] }} me-2 text-white"></i>
          <h5 class="mb-0 text-white">{{ meal }}</h5>
        </div>
        <div class="card-body">
          {% set meal_suggestions = suggestions | selectattr('meal_type', 'equalto', meal) | list %}
          {% if meal_suggestions %}
          <ul class="list-group list-group-flush">
            {% for item in meal_suggestions %}
            <li class="list-group-item d-flex justify-content-between align-items-center" style="cursor:pointer;" onclick="openIngredientModal('{{ item.item_name|lower }}')">
              <span><i class="fas fa-concierge-bell me-2 text-muted"></i>{{ item.item_name }}</span>
              <span class="badge rounded-pill" style="background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);">{{ item.suggested_quantity }} {{ item.unit }}</span>
            </li>
            {% endfor %}
          </ul>
          {% else %}
          <p class="text-muted text-center py-3">No suggestions available.</p>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Ingredients Section -->
  <h4 class="fw-bold my-5 text-dark"><i class="fas fa-apple-alt me-2"></i>Ingredients Needed Today</h4>
  <div class="card border-0 shadow rounded-4 bg-white animate__animated animate__fadeInUp">
    <div class="card-header bg-gradient text-white rounded-top-4" style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
      <h5 class="mb-0"><i class="fas fa-carrot me-2"></i>Ingredient List</h5>
    </div>
    <div class="card-body">
      {% if ingredients %}
      <div class="table-responsive">
        <table class="table align-middle table-hover">
          <thead class="sticky-top bg-light">
            <tr class="text-center">
              <th>Ingredient</th>
              <th>Required Quantity</th>
            </tr>
          </thead>
          <tbody>
            {% for ing in ingredients %}
            <tr class="text-center">
              <td class="text-start">üõí {{ ing.ingredient | capitalize }}</td>
              <td><span class="badge rounded-pill bg-success">{{ ing.required_quantity }}</span></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-muted text-center">No ingredient data available.</p>
      {% endif %}
    </div>
  </div>

  <!-- Ingredient Modal -->
  <div class="modal fade" id="ingredientModal" tabindex="2" aria-labelledby="ingredientModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 shadow-lg" style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);">
        <div class="modal-header border-0 bg-gradient text-white rounded-top-4" style="background:linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
          <h5 class="modal-title" id="ingredientModalLabel">Ingredients Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <ul class="list-group" id="ingredientList"></ul>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- FontAwesome & Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
// JS function to open modal and display ingredients
const ingredientsData = {{ item_ingredients|tojson }};

function openIngredientModal(itemName) {
  const modal = new bootstrap.Modal(document.getElementById('ingredientModal'));
  const list = document.getElementById('ingredientList');
  list.innerHTML = '';

  const ingredients = ingredientsData[itemName];
  if (ingredients) {
    for (const [key, value] of Object.entries(ingredients)) {
      list.innerHTML += `<li class="list-group-item d-flex justify-content-between align-items-center">
        ü•Ñ ${key.replace('_', ' ')}
        <span class="badge bg-primary rounded-pill">${value}</span>
      </li>`;
    }
  } else {
    list.innerHTML = '<li class="list-group-item text-muted text-center">No ingredients found.</li>';
  }
  modal.show();
}
</script>


<!-- Attendance Section -->
<div id="attendance" class="hidden animate__animated animate__fadeIn">
  <div class="card mb-4 p-4">
    <h5 class="card-title mb-3"><i class="bi bi-clipboard2-check me-2"></i>Record Attendance</h5>
    <form method="POST" action="{{ url_for('admin_dashboard') }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="hidden" name="form_type" value="attendance">
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Date</label>
          <input type="date" class="form-control" name="date" value="{{ datetime.now().strftime('%Y-%m-%d') }}" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Student Count</label>
          <input type="number" class="form-control" name="student_count" min="1" required placeholder="Enter number of students">
        </div>
      </div>
      <div class="mt-3">
        <button type="submit" class="btn btn-success w-100">
          <i class="bi bi-save2-fill me-2"></i> Save Attendance
        </button>
      </div>
    </form>
  </div>

  <div class="card p-4">
    <h5 class="card-title mb-3"><i class="bi bi-card-checklist me-2"></i>Recent Attendance</h5>

    <div class="mb-3">
      <input type="text" id="attendanceFilter" class="form-control" placeholder="Filter by Date or Student Count...">
    </div>

    <div class="row" id="attendanceCards">
      {% for record in attendance %}
      <div class="col-md-4 mb-4 attendance-card">
        <div class="card shadow-sm border-0 h-100 text-center">
          <div class="card-body">
            <h6 class="fw-bold">{{ record.date.strftime('%d-%b-%Y') }}</h6>
            <p class="text-muted mb-0">Students: {{ record.student_count }}</p>
          </div>
        </div>
      </div>
      {% else %}
      <div class="col-12 text-center text-muted">
        No Attendance Records Found
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- Menus Section -->
<div id="menus" class="hidden animate__animated animate__fadeIn">
  <div class="card mb-4 p-4">
    <h5 class="card-title mb-3"><i class="bi bi-journal-plus me-2"></i>Add Menu</h5>
    <form method="POST" action="{{ url_for('admin_dashboard') }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <input type="hidden" name="form_type" value="menu">
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Day</label>
          <select class="form-select" name="day" required>
            <option value="">Select Day</option>
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
            <option>Sunday</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">Meal Type</label>
          <select class="form-select" name="meal_type" required>
            <option value="">Select Meal Type</option>
            <option>Breakfast</option>
            <option>Lunch</option>
            <option>Snacks</option>
            <option>Dinner</option>
          </select>
        </div>
        <div class="col-12">
          <label class="form-label">Items (comma separated)</label>
          <input type="text" class="form-control" name="items" placeholder="e.g. Idly, Vada, Sambar" required>
        </div>
      </div>
      <div class="mt-3">
        <button type="submit" class="btn btn-primary w-100">
          <i class="bi bi-cloud-upload-fill me-2"></i> Save Menu
        </button>
      </div>
    </form>
  </div>

  <div class="card p-4">
    <h5 class="card-title mb-3"><i class="bi bi-card-list me-2"></i>All Menus</h5>

    <div class="scroll-table">
      <table class="table table-hover table-bordered align-middle">
        <thead class="table-light">
          <tr class="text-center">
            <th>Day</th>
            <th>Meal Type</th>
            <th>Items</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for menu in menus %}
          <tr>
            <td class="text-center fw-semibold">{{ menu.day }}</td>
            <td class="text-center">
              <span class="badge bg-primary">{{ menu.meal_type }}</span>
            </td>
            <td>
              <ul class="list-unstyled mb-0">
                {% for item in menu['items'].split(',') %}
                  <li>üçΩÔ∏è {{ item.strip() }}</li>
                {% endfor %}
              </ul>
            </td>
            <td class="text-center">
              <button class="btn btn-sm btn-warning" onclick="openEditModal({{ menu.id }}, '{{ menu.day }}', '{{ menu.meal_type }}', '{{ menu.items }}')">
                <i class="bi bi-pencil-square"></i>
              </button>
              <a href="{{ url_for('delete_menu', menu_id=menu.id) }}" class="btn btn-sm btn-danger">
                <i class="bi bi-trash3-fill"></i>
              </a>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="4" class="text-center">No Menu Records Found</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Settings Section -->
<div id="settings" class="hidden animate__animated animate__fadeIn">
  <div class="card mb-4 p-4">
    <h5 class="card-title mb-3"><i class="bi bi-person-gear me-2"></i>Manage Admin Settings</h5>
    <form method="POST" action="{{ url_for('update_admin_settings') }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <div class="mb-3">
        <label class="form-label">Full Name</label>
        <input type="text" class="form-control" name="full_name" value="{{ admin.full_name }}" required>
      </div>
      <div class="mb-3">
        <label class="form-label">New Password <small class="text-muted">(leave blank if not changing)</small></label>
        <input type="password" class="form-control" name="new_password" placeholder="New Password">
      </div>
      <div class="mb-3">
        <label class="form-label">Confirm New Password</label>
        <input type="password" class="form-control" name="confirm_password" placeholder="Confirm New Password">
      </div>
      <div class="mt-3">
        <button type="submit" class="btn btn-primary w-100">
          <i class="bi bi-save2-fill me-2"></i> Save Changes
        </button>
      </div>
    </form>
  </div>
</div>

</div> <!-- container-fluid -->
</div> <!-- main -->

<!-- Edit Menu Modal -->
<div class="modal fade" id="editMenuModal" tabindex="-1" aria-labelledby="editMenuModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <form method="POST" id="editMenuForm">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editMenuModalLabel">Edit Menu</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <div class="mb-3">
            <label class="form-label">Day</label>
            <select class="form-select" name="day" id="editDay" required>
              <option>Monday</option>
              <option>Tuesday</option>
              <option>Wednesday</option>
              <option>Thursday</option>
              <option>Friday</option>
              <option>Saturday</option>
              <option>Sunday</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">Meal Type</label>
            <select class="form-select" name="meal_type" id="editMealType" required>
              <option>Breakfast</option>
              <option>Lunch</option>
              <option>Snacks</option>
              <option>Dinner</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">Items</label>
            <input type="text" class="form-control" name="items" id="editItems" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Save Changes</button>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- Scripts -->
<script>
function openEditModal(id, day, mealType, items) {
  const form = document.getElementById('editMenuForm');
  form.action = '/edit-menu/' + id;
  document.getElementById('editDay').value = day;
  document.getElementById('editMealType').value = mealType;
  document.getElementById('editItems').value = items;
  var editModal = new bootstrap.Modal(document.getElementById('editMenuModal'));
  editModal.show();
}

// Section switching
function showSection(sectionId) {
  const sections = ['dashboard', 'attendance', 'menus', 'settings'];
  sections.forEach(id => {
    document.getElementById(id).classList.add('hidden');
  });
  document.getElementById(sectionId).classList.remove('hidden');
}

// Auto-switch based on hash
document.addEventListener("DOMContentLoaded", function() {
  const hash = window.location.hash.substring(1);
  if (hash && ['dashboard', 'attendance', 'menus', 'settings'].includes(hash)) {
    showSection(hash);
  } else {
    showSection('dashboard');
  }
});

// Attendance filter
document.getElementById('attendanceFilter').addEventListener('input', function() {
  let filter = this.value.toLowerCase();
  let cards = document.querySelectorAll('.attendance-card');

  cards.forEach(card => {
    let date = card.querySelector('h6').innerText.toLowerCase();
    let count = card.querySelector('p').innerText.toLowerCase();
    if (date.includes(filter) || count.includes(filter)) {
      card.style.display = "block";
    } else {
      card.style.display = "none";
    }
  });
});
</script>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <script>
      {% for category, message in messages %}
      Swal.fire({
        toast: true,
        position: 'top-end',
        icon: '{{ category }}',
        title: '{{ message }}',
        showConfirmButton: false,
        timer: 2000
      });
      {% endfor %}
    </script>
  {% endif %}
{% endwith %}

<!-- Bootstrap Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
